{"ast":null,"code":"import axios from \"axios\";\nimport { CART_ADD_ITEM, CART_REMOVE_ITEM, CART_SAVE_SHIPPING_ADDRESS, CART_SAVE_PAYMENT_METHOD, CALCULAR_FRETE_FAIL, CALCULAR_FRETE_REQUEST, CALCULAR_FRETE_SUCCESS } from \"../constants/cartConstants\";\nexport const addToCart = (id, qtd) => async (dispatch, getState) => {\n  const {\n    data\n  } = await axios.get(`/api/products/${id}`);\n  dispatch({\n    type: CART_ADD_ITEM,\n    payload: {\n      product: data._id,\n      name: data.name,\n      image: data.image,\n      price: data.price,\n      countInStock: data.countInStock,\n      weight: data.weight,\n      qtd\n    }\n  });\n  localStorage.setItem(\"cartItems\", JSON.stringify(getState().cart.cartItems));\n};\nexport const removefromcart = id => (dispatch, getState) => {\n  dispatch({\n    type: CART_REMOVE_ITEM,\n    payload: id\n  });\n  localStorage.setItem(\"cartItems\", JSON.stringify(getState().cart.cartItems));\n};\nexport const saveShippingAddress = data => (dispatch, getState) => {\n  dispatch({\n    type: CART_SAVE_SHIPPING_ADDRESS,\n    payload: data\n  });\n  localStorage.setItem(\"shippingAddress\", JSON.stringify(getState().cart.shippingAddress));\n};\nexport const savePaymentMethod = data => dispatch => {\n  dispatch({\n    type: CART_SAVE_PAYMENT_METHOD,\n    payload: data\n  });\n  localStorage.setItem(\"paymentMethod\", JSON.stringify(data));\n};\nexport const calcularFrete = () => async dispatch => {\n  try {\n    dispatch({\n      type: CALCULAR_FRETE_REQUEST\n    });\n    const config = {\n      headers: {\n        \"Content-Type\": \"application/json\"\n      }\n    };\n    const cepDestino = JSON.parse(localStorage.getItem(\"shippingAddress\")).postalCode;\n    let pesoProduto = 0;\n    JSON.parse(localStorage.getItem(\"cartItems\").map(x => pesoProduto += x.product.qtd * x.product.price));\n    console.log(cepDestino, pesoProduto);\n    const {\n      data\n    } = await axios.post(`api/correios/frete`, {\n      cepDestino,\n      pesoProduto\n    }, config);\n    console.log(data);\n    dispatch({\n      type: CALCULAR_FRETE_SUCCESS,\n      payload: data\n    });\n    localStorage.setItem(\"frete\", JSON.stringify(data));\n  } catch (error) {\n    dispatch({\n      type: CALCULAR_FRETE_FAIL,\n      payload: error.response && error.response.data.message ? error.response.data.message : error.message\n    });\n  }\n};","map":{"version":3,"names":["axios","CART_ADD_ITEM","CART_REMOVE_ITEM","CART_SAVE_SHIPPING_ADDRESS","CART_SAVE_PAYMENT_METHOD","CALCULAR_FRETE_FAIL","CALCULAR_FRETE_REQUEST","CALCULAR_FRETE_SUCCESS","addToCart","id","qtd","dispatch","getState","data","get","type","payload","product","_id","name","image","price","countInStock","weight","localStorage","setItem","JSON","stringify","cart","cartItems","removefromcart","saveShippingAddress","shippingAddress","savePaymentMethod","calcularFrete","config","headers","cepDestino","parse","getItem","postalCode","pesoProduto","map","x","console","log","post","error","response","message"],"sources":["C:/Users/josef/OneDrive/Área de Trabalho/IFSC/PI/e-commerce/client/src/redux/actions/cartActions.jsx"],"sourcesContent":["import axios from \"axios\";\r\nimport {\r\n  CART_ADD_ITEM,\r\n  CART_REMOVE_ITEM,\r\n  CART_SAVE_SHIPPING_ADDRESS,\r\n  CART_SAVE_PAYMENT_METHOD,\r\n  CALCULAR_FRETE_FAIL,\r\n  CALCULAR_FRETE_REQUEST,\r\n  CALCULAR_FRETE_SUCCESS\r\n} from \"../constants/cartConstants\";\r\n\r\nexport const addToCart = (id, qtd) => async (dispatch, getState) => {\r\n  const { data } = await axios.get(`/api/products/${id}`);\r\n\r\n  dispatch({\r\n    type: CART_ADD_ITEM,\r\n    payload: {\r\n      product: data._id,\r\n      name: data.name,\r\n      image: data.image,\r\n      price: data.price,\r\n      countInStock: data.countInStock,\r\n      weight: data.weight,\r\n      qtd,\r\n    },\r\n  });\r\n\r\n  localStorage.setItem(\"cartItems\", JSON.stringify(getState().cart.cartItems));\r\n};\r\n\r\nexport const removefromcart = (id) => (dispatch, getState) => {\r\n  dispatch({\r\n    type: CART_REMOVE_ITEM,\r\n    payload: id,\r\n  });\r\n\r\n  localStorage.setItem(\"cartItems\", JSON.stringify(getState().cart.cartItems));\r\n};\r\n\r\n\r\nexport const saveShippingAddress = (data) => (dispatch, getState) => {\r\n  dispatch({\r\n    type: CART_SAVE_SHIPPING_ADDRESS,\r\n    payload: data,\r\n  });\r\n\r\n  localStorage.setItem(\"shippingAddress\", JSON.stringify(getState().cart.shippingAddress));\r\n};\r\n\r\n\r\nexport const savePaymentMethod = (data) => (dispatch) => {\r\n  dispatch({\r\n    type: CART_SAVE_PAYMENT_METHOD,\r\n    payload: data,\r\n  });\r\n\r\n  localStorage.setItem(\"paymentMethod\", JSON.stringify(data));\r\n};\r\n\r\nexport const calcularFrete = () => async(dispatch) => {\r\n  try {\r\n    dispatch({ type: CALCULAR_FRETE_REQUEST });\r\n\r\n    const config = {\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n    };\r\n\r\n    const cepDestino = JSON.parse(localStorage.getItem(\"shippingAddress\")).postalCode;\r\n\r\n    let pesoProduto = 0;\r\n    JSON.parse(localStorage.getItem(\"cartItems\").map((x) => pesoProduto += x.product.qtd * x.product.price));\r\n\r\n    console.log(cepDestino, pesoProduto);\r\n\r\n    const { data } = await axios.post(\r\n      `api/correios/frete`,\r\n      {cepDestino, pesoProduto},\r\n      config\r\n    );\r\n\r\n    console.log(data);\r\n\r\n    dispatch({ type: CALCULAR_FRETE_SUCCESS, payload: data });\r\n\r\n    localStorage.setItem(\"frete\", JSON.stringify(data));\r\n  } catch (error) {\r\n    dispatch({\r\n      type: CALCULAR_FRETE_FAIL,\r\n      payload:\r\n        error.response && error.response.data.message\r\n          ? error.response.data.message\r\n          : error.message,\r\n    });\r\n  }\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}